project openbus/demos/sharedauth ;

path-constant here : . ;

obj hello-idl
  : $(here)/idl/hello.idl
    /mico//mico
  ;
explicit hello-idl ;

obj sharedauth-idl
  : $(here)/idl/sharedauth.idl
    /mico//mico
  ;
explicit sharedauth-idl ;

local rule demo-exe ( name : src : deps * )
{
  exe $(name)
    : src/$(src).cpp
      /openbus//openbus
      /scs//scs
      /logger//logger
      /mico//mico
      /openssl//openssl
      /boost//headers
      /boost//program_options
      /openbus//core-idls
      /scs//scs-idl
      $(deps)
    : <implicit-dependency>/openbus//core-idls
      <threading>multi:<source>/boost//thread
      <link>static,<target-os>linux:<source>/dl//dl
      <implicit-dependency>$(deps)
    ;
  explicit $(name) ;
}

demo-exe sharedauth_client : client : hello-idl sharedauth-idl ;
demo-exe sharedauth_client_sharedauth : client_sharedauth : hello-idl sharedauth-idl ;
demo-exe sharedauth_server : server : hello-idl sharedauth-idl ;

alias sharedauth
  : sharedauth_client
    sharedauth_client_sharedauth
    sharedauth_server
  ;
