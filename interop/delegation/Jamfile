project openbus/interop/delegation
  : requirements
    <include>../ <include>../../
    <use>/boost//headers
  ;

path-constant here : . ;

obj messages-stub
  : $(here)/idl/messages.idl
  : <warnings>off
  ;
explicit messages-stub ;

obj messages-skeleton
  : $(here)/idl/messages.idl
  : <generate>skeleton
  <warnings>off
  ;
explicit messages-skeleton ;

exe delegation_client
  : src/client.cpp
    /openbus//openbus
    /boost//program_options
    /boost//regex
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    messages-stub
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>messages-stub
    <implicit-dependency>messages-stub
    <link>static,<target-os>linux:<source>/dl//dl  
  ;
explicit delegation_client ;

exe delegation_forwarder
  : src/forwarder.cpp
    /openbus//openbus
    /boost//program_options
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    messages-stub
    messages-skeleton
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>messages-stub
    <implicit-dependency>messages-stub
    <dependency>messages-skeleton
    <implicit-dependency>messages-skeleton
    <link>static,<target-os>linux:<source>/dl//dl   
  ;
explicit delegation_forwarder ;

exe delegation_broadcaster
  : src/broadcaster.cpp
    /openbus//openbus
    /boost//program_options
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    messages-stub
    messages-skeleton
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>messages-stub
    <implicit-dependency>messages-stub
    <dependency>messages-skeleton
    <implicit-dependency>messages-skeleton
    <link>static,<target-os>linux:<source>/dl//dl   
  ;
explicit delegation_broadcaster ;

exe delegation_messenger
  : src/messenger.cpp
    /openbus//openbus
    /boost//program_options
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    messages-stub
    messages-skeleton
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>messages-stub
    <implicit-dependency>messages-stub
    <dependency>messages-skeleton
    <implicit-dependency>messages-skeleton
    <link>static,<target-os>linux:<source>/dl//dl   
  ;
explicit delegation_messenger ;

alias delegation
  : delegation_client
    delegation_forwarder
    delegation_broadcaster
    delegation_messenger
  ;
