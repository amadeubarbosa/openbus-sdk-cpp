import os ;

project openbus/interop/reloggedjoin
  : requirements
    <include>../ <include>../../
    <use>/boost//headers
  ;

path-constant here : . ;

interop-basic-idl-path = [ os.environ INTEROP_BASIC_IDL_PATH ] ;
if ! $(interop-basic-idl-path)
{
  interop-basic-idl-path = $(here)/../../../openbus-sdk-idl-interop-basic ;
}

obj hello-stub
  : $(interop-basic-idl-path)/hello.idl
  : <warnings>off
  ;
explicit hello-stub ;

obj hello-skeleton
  : $(interop-basic-idl-path)/hello.idl
  : <generate>skeleton
    <warnings>off
  ;
explicit hello-skeleton ;

exe reloggedjoin_client
  : src/client.cpp
    /openbus//openbus
    /boost//program_options
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    hello-stub
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>hello-stub
    <implicit-dependency>hello-stub
    <link>static,<target-os>linux:<source>/dl//dl  
  ;
explicit reloggedjoin_client ;

exe reloggedjoin_server
  : src/server.cpp
    /openbus//openbus
    /boost//program_options
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    hello-stub
    hello-skeleton
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>hello-stub
    <implicit-dependency>hello-stub
    <dependency>hello-skeleton
    <implicit-dependency>hello-skeleton
    <link>static,<target-os>linux:<source>/dl//dl   
  ;
explicit reloggedjoin_server ;

exe reloggedjoin_proxy
  : src/proxy.cpp
    /openbus//openbus
    /boost//program_options
    /scs//scs
    /logger//logger
    /openssl//openssl
    /TAO//TAO
    hello-stub
    hello-skeleton
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>hello-stub
    <implicit-dependency>hello-stub
    <dependency>hello-skeleton
    <implicit-dependency>hello-skeleton
    <link>static,<target-os>linux:<source>/dl//dl   
  ;
explicit reloggedjoin_proxy ;

alias reloggedjoin
  : reloggedjoin_client
    reloggedjoin_server
    reloggedjoin_proxy
  ;
