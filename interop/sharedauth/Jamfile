project openbus/interop/sharedauth
 : requirements
   <include>../
 ;

path-constant here : . ;

obj hello-idl : $(here)/idl/hello/hello.idl /mico//mico ;
obj encoding-idl : $(here)/idl/sharedauth/encoding.idl /mico//mico ;

exe sharedauth_client
  : src/client.cpp 
    hello-idl 
    encoding-idl
    /openbus//openbus 
    /scs//scs 
    /logger//logger 
    /mico//mico
    /boost//headers 
    /boost//program_options 
    /openssl//openssl    
  : <threading>multi:<source>/boost//thread
    <implicit-dependency>/openbus//core-idls
    <target-os>windows,<link>shared:<library>/openbus//core-idls #TODO
    <implicit-dependency>hello-idl
    <implicit-dependency>encoding-idl
    <target-os>linux,<link>static:<source>/dl//dl
;

exe sharedauth_server
  : src/server.cpp 
    hello-idl 
    encoding-idl
    /openbus//openbus 
    /scs//scs 
    /logger//logger 
    /mico//mico
    /boost//headers 
    /boost//program_options 
    /openssl//openssl
  : <threading>multi:<source>/boost//thread
    <implicit-dependency>/openbus//core-idls
    <implicit-dependency>hello-idl
    <implicit-dependency>encoding-idl
    <target-os>linux,<link>static:<source>/dl//dl
;

exe sharedauth_sharedauth
  : src/sharedauth.cpp 
    hello-idl 
    encoding-idl
    /openbus//openbus 
    /scs//scs 
    /logger//logger 
    /mico//mico
    /boost//headers 
    /boost//program_options 
    /openssl//openssl
  : <threading>multi:<source>/boost//thread
    <implicit-dependency>/openbus//core-idls
    <target-os>windows,<link>shared:<library>/openbus//core-idls #TODO
    <implicit-dependency>hello-idl
    <implicit-dependency>encoding-idl
    <target-os>linux,<link>static:<source>/dl//dl
;

alias sharedauth
  : sharedauth_client
    sharedauth_sharedauth
    sharedauth_server
    admin/interop_sharedauth_cpp_sharedauth.key
    admin/interop_sharedauth_cpp_server.key
;
