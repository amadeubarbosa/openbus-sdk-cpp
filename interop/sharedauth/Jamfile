project openbus/interop/sharedauth
  : requirements <include>../ <include>../../
  ;

path-constant here : . ;

obj hello-stub
  : $(here)/idl/hello/hello.idl
  ;
explicit hello-stub ;

obj hello-skeleton
  : $(here)/idl/hello/hello.idl
  : <generate>skeleton
  ;
explicit hello-skeleton ;

obj encoding-stub
  : $(here)/idl/sharedauth/encoding.idl
  ;
explicit encoding-stub ;

exe sharedauth_client
  : src/client.cpp 
    /openbus//openbus 
    /scs//scs 
    /logger//logger 
    /boost//headers 
    /boost//program_options 
    /openssl//openssl    
    /TAO//TAO
    hello-stub
    encoding-stub
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>hello-stub
    <implicit-dependency>hello-stub
    <dependency>encoding-stub
    <implicit-dependency>encoding-stub
    <link>static,<target-os>linux:<source>/dl//dl
  ;
explicit sharedauth_client ;

exe sharedauth_server
  : src/server.cpp 
    /openbus//openbus 
    /scs//scs 
    /logger//logger 
    /boost//headers 
    /boost//program_options 
    /openssl//openssl
    /TAO//TAO
    hello-stub
    hello-skeleton
    encoding-stub
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>hello-stub
    <implicit-dependency>hello-stub
    <dependency>hello-skeleton
    <implicit-dependency>hello-skeleton
    <dependency>encoding-stub
    <implicit-dependency>encoding-stub
    <link>static,<target-os>linux:<source>/dl//dl
  ;
explicit sharedauth_server ;

exe sharedauth_sharedauth
  : src/sharedauth.cpp 
    /openbus//openbus 
    /scs//scs 
    /logger//logger 
    /boost//headers 
    /boost//program_options
    /boost//filesystem
    /openssl//openssl
    /TAO//TAO
    hello-stub
    hello-skeleton
  : <threading>multi:<source>/boost//thread
    <target-os>windows:<library>/openbus//idls
    <target-os>windows:<library>/scs//scs-stub
    <dependency>hello-stub
    <implicit-dependency>hello-stub
    <dependency>hello-skeleton
    <implicit-dependency>hello-skeleton
    <dependency>encoding-stub
    <implicit-dependency>encoding-stub
    <link>static,<target-os>linux:<source>/dl//dl
  ;
explicit sharedauth_sharedauth ;

alias sharedauth
  : sharedauth_client
    sharedauth_sharedauth
    sharedauth_server
    admin/interop_sharedauth_cpp_sharedauth.key
    admin/interop_sharedauth_cpp_server.key
  ;
