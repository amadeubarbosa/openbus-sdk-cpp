
# Descomente a linha abaixo para ativar o modo debug.
#DBG=Yes

# Descomente a linha abaixo para o uso em Valgrind.
# p.s.: O modo debug(DBG) deve estar ativado.
#CPPFLAGS= -fno-inline

ORBIX_HOME=${IT_PRODUCT_DIR}/asp/6.3

ORBIXBIN=${ORBIX_HOME}/bin
ORBIXINC=${ORBIX_HOME}/include
ORBIXLDIR=${ORBIX_HOME}/lib

# general config
ifeq ($(TEC_WORDSIZE), TEC_64)
  ORBIXLDIR=${ORBIX_HOME}/lib/lib64
else
  ORBIXLDIR=${ORBIX_HOME}/lib
endif

ifeq "$(TEC_UNAME)" "SunOS510_64"
  USE_CC=Yes

  ifeq "$(DBG)" "Yes"
    CPPFLAGS= -g
  endif

  CPPFLAGS+= +p -KPIC -mt -m64 -D_REENTRANT -library=stlport4
  ORBIXLDIR=${ORBIX_HOME}/lib/sparcv9
  LFLAGS= $(CPPFLAGS) -xildoff
endif

DEFINES=SCS_ORBIX
DEFINES+=OPENBUS_ORBIX

OPENBUSINC = ${OPENBUS_HOME}/include
OPENBUSLIB = ${OPENBUS_HOME}/lib

INCLUDES= . \
  ../../util \
  ../stubs \
  ${ORBIXINC} \
  ${OPENBUSINC}/openbus/cpp \
  ${OPENBUSINC} \
  ${OPENBUSINC}/cxxtest \
  ${OPENBUSINC}/openssl-0.9.9 \
  ${OPENBUSINC}/logger

AUXILIAR_SRC= ../util/auxiliar.cpp

LDIR= ${ORBIXLDIR} ${OPENBUSLIB}

LIBS= crypto it_poa it_art it_ifc it_portable_interceptor logger

SLIB= ${OPENBUSLIB}/libopenbusorbix.a \
      ${OPENBUSLIB}/libscsorbix.a \
      ${OPENBUSLIB}/liblogger.a

USE_LUA51= YES
USE_NODEPEND= YES

OBJROOT= obj
TARGETROOT= bin

STUBS= ../stubs/RGSTest.hh ../stubs/RGSTestS.cxx

IDLS: ../idl/RGSTest.idl

$(STUBS): $(IDLS)
	mkdir -p ../stubs
	cd ../stubs ; ${OPENBUS_HOME}/specs/shell/orbix/idl -base -poa ../../idl/RGSTest.idl

genstubs: $(STUBS)
